<% include functions %>
<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <title>Orden de reparación</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://bootswatch.com/4/cosmo/bootstrap.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/public/css/app.css">
<style>
.gray-sts{
    color: #9e9e9e;
}
</style>
</head>
<div class="container" style="text-align: center;padding-top: 18px;">

    <div class="row">
        <div class="col-md-12">
            <a href="<%= (userrol == 0 ? '/tech_reparations' : '/reparations' ) %>"><img src="https://axaserviz.com/app/static/media/logo_last_stop_appliances_color.d0a865ce.png" width="155"></a>
            <h2>Orden de reparación</h2>
            <p class="mb-1" style="font-size: 24px;">#
                <%= reparation[0].id %>-<%= reparation[0].reparation_code %>
            </p>
            <p class="mb-1 gray-sts">Fecha de creación :
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <%= reparation[0].created_at.toLocaleString('en') %>
            </p>
            <p class="pb-0 gray-sts">Fecha estimada de visita :
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <%= reparation[0].stimate_date.toLocaleString('en').split(",")[0] %> <i class="fa fa-clock-o" aria-hidden="true"></i> <%= tConvert(reparation[0].stimate_hour) %>
            </p>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>Cliente : <a href="http://maps.google.com/?q=<%= reparation[0].client_addres %>+<%= reparation[0].client_city %>+<%= reparation[0].state_id %>" class="text-uppercase"><i class="fa fa-user-circle" aria-hidden="true"></i> <%= reparation[0].client_name %> <%= reparation[0].client_last_name %></a></h4>
                </div>
                <div class="panel-body">
                    <p class="mb-1 text-uppercase">
                        <a href="http://maps.google.com/?q=<%= reparation[0].client_addres %>+<%= reparation[0].client_city %>+<%= reparation[0].state_id %>" target="_blank">
                            <i class="fa fa-map-marker" aria-hidden="true"></i>
                            <%= reparation[0].client_addres %>, <%= reparation[0].client_city %>, <%= reparation[0].state_fullname %> <br>
                        </a>
                    </p>
                    <p style="margin: 0;">
                        <% if(reparation[0].phone){ %>
                            <a href="tel:<%= reparation[0].phone %>">
                                <i class="fa fa-phone-square" aria-hidden="true"></i>
                                <%= reparation[0].phone %>
                            </a> <br>
                        <% } %>
                        <% if(reparation[0].phone2){ %>
                            <a href="tel:<%= reparation[0].phone2 %>">
                                <i class="fa fa-phone-square" aria-hidden="true"></i>
                                <%= reparation[0].phone2 %>
                            </a> <br>
                        <% } %>
                        <% if(reparation[0].phone3){ %>
                            <a href="tel:<%= reparation[0].phone3 %>">
                                <i class="fa fa-phone-square" aria-hidden="true"></i>
                                <%= reparation[0].phone3 %>
                            </a> <br>
                        <% } %>
                    </p>
                </div>
            </div>
        </div>
    </div> <!-- / end client details section -->
<hr>
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="mb-1 gray-sts">
                        Estado actual <br>
                    </p>
                    <p class="alert text-uppercase status-<%= reparation[0].status_id %>" style="border-radius: .25rem; color: #dcdcdc;">
                        <strong><%= reparation[0].status_name %></strong> <br>
                    </p>
                </div>
            </div>
        </div>
    </div>
<hr>
<!-- REPARATION DETAILS -->
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="mb-1 gray-sts pull-left">
                        Técnico asignado
                    </p>
                    <p class="mb-1 pull-right text-uppercase">
                        <strong><a href="#"><i class="fa fa-user-circle" aria-hidden="true"></i> <%= reparation[0].tech_name %></a></strong>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="mb-1 gray-sts pull-left">
                        Tipo de reparación
                    </p>
                    <p class="mb-1 pull-right">
                        <%= reparation[0].reparation_type %>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="mb-1 gray-sts pull-left">
                        Forma de pago
                    </p>
                    <p class="mb-1 pull-right">
                        <%= reparation[0].payment_type %>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <hr style="background: black;">
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="mb-1 pull-left">
                        <strong>Costo de chequeo</strong>
                    </p>
                    <p class="mb-1 pull-right">
                        <strong>$<%= reparation[0].check_price %></strong>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <hr style="background: black;">
    <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 pull-left">
                            <strong>Costo de reparación</strong>
                        </p>
                        <p class="mb-1 pull-right">
                            <strong>$<%= reparation[0].total_paid %></strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <hr style="background: black;">
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="mb-1 gray-sts pull-center">
                        Electrodomestico a reparar
                    </p>
                    <p class="mb-1 pull-center">
                        <img src="<%= reparation[0].device_image %>" alt="Device" style="width: 50%;">
                    </p>
                    <p class="mb-1 pull-center text-uppercase">
                        <strong><%= reparation[0].device_name %></strong>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 gray-sts pull-left">
                            Tipo de electrodomestico
                        </p>
                        <p class="mb-1 pull-right">
                            <%= reparation[0].device_type_name %>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 gray-sts pull-left">
                            Marca
                        </p>
                        <p class="mb-1 pull-right">
                            <img src="<%= reparation[0].manufacturer_image %>" style="width: 80px;"> <%= reparation[0].manufacturer_name %> 
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 gray-sts pull-left">
                            Modelo
                        </p>
                        <p class="mb-1 pull-right">
                            <%= reparation[0].device_model %> 
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <% if(reparation[0].breakdowns != null){ %>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 pull-center">
                            <strong>Fallas reportadas por el cliente</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <ul class="list-group">
                            <% for(var i = 0; i < breakdowns.length; i++) { %>
                                <% var breakdownDbArray = reparation[0].breakdowns.split(','); %>
                                <% if(breakdownDbArray.includes(breakdowns[i].id.toString())){ %>
                                    <li class="list-group-item text-uppercase" style="background: #9e9e9e; color: #fff;"> <%= breakdowns[i].name %></li>
                                <%} %>                                
                            <% } %>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <% } %>
        <% if(reparation[0].breakdowns_tech != null){ %>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 pull-center">
                            <strong>Fallas detectadas por el tecnico</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <ul class="list-group">
                            <% for(var i = 0; i < breakdowns.length; i++) { %>
                                <% var breakdownDbArray = reparation[0].breakdowns_tech.split(','); %>
                                <% if(breakdownDbArray.includes(breakdowns[i].id.toString())){ %>
                                    <li class="list-group-item text-uppercase" style="background: #9e9e9e; color: #fff;"> <%= breakdowns[i].name %></li>
                                <%} %>   
                            <% } %>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <% } %>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 pull-center">
                            <strong>Diagnosticos del técnico</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <ul class="list-group">
                            <li class="list-group-item text-uppercase"><%= reparation[0].diagnostics %></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <p class="mb-1 pull-center">
                            <strong>Notas y/o comentarios</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <ul class="list-group">
                            <li class="list-group-item text-uppercase"><%= reparation[0].comments %></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="row" style="padding: 20px;">
            <div class="col-md-12 text-center">
                <a href="<%= (userrol == 0 ? '/tech_reparations' : '/reparations' ) %>" class="btn btn-primary btn-lg"><i class="fa fa-arrow-left" aria-hidden="true"></i> Ir al sistema</a>
            </div>
        </div>
</div>
